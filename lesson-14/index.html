<!DOCTYPE HTML>
<html lang="en">
<head>
    <title>Web технологии</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=792, user-scalable=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <link rel="stylesheet" href="../node_modules/shower-bright/styles/screen.css">
    <link rel="stylesheet" href="../css/highlight/github.css">
    <link rel="stylesheet" href="../css/index.css">
</head>
<body class="list">
    <header class="caption">
        <h1>Web технологии</h1>
        <p><a href="https://github.com/mialinx/">Дмитрий Смаль</a></p>
    </header>

    <section class="slide shout"><div>
        <h2>Обработка форм</h2>
    </div></section>

    <section class="slide"><div>
        <h2>GET / POST формы</h2>
        <p>
            <b>GET</b> - метод для <b>получения</b> данных. GET запросы могут быть закешированны промежуточными серверами.
            <b>GET</b> должен применяться только в <b>поисковых</b> формах.
        </p>
        <p>
            <b>POST</b> - метод для изменения данных. POST запросы никогда не кешируются промежуточными серверами.
            <b>POST</b> должен применяться в формах, <b>изменяющих данные</b> на сервере.
    </div></section>

    <section class="slide"><div>
        <h2>Общий сценарий обработки</h2>
        <img src="pictures/forms.png" class="center">
    </div></section>

    <section class="slide"><div>
        <h2>Best practice</h2>
        <ul>
            <li><b>Всегда</b> проверять пользовательские данные</li>
            <li>Для форм, изменяющих данные использовать метод <b>POST</b></li>
            <li>Не заставлять вводить данные повторно</li>
            <li>Сообщать об ошибках детально - по полям</li>
            <li>Сообщать об успешном сохранении кода</li>
            <li>При успешном сохранении делать перенаправление</li>
        </ul>
    </div></section>

    <section class="slide shout"><div>
        <h2>HTTP Redirects</h2>
    </div></section>

    <section class="slide"><div>
        <h2>HTTP Redirects</h2>
        <img src="pictures/redirect.png" class="center">
    </div></section>

    <section class="slide"><div>
        <h2>HTTP Redirects</h2>
        <ul>
            <li><code>302 Found</code> - временное перенаправление</li>
            <li><code>301 Moved Permanently</code> - постоянное перенаправление (кешируется в браузере)</li>
            <li><code>Location: url</code> - URL для повторного запроса. Может быть как абсолютным так и относительным.</li>
        </ul>
    </div></section>

    <section class="slide"><div>
        <h2>Перенаправления в Django</h2>
        <script type="snippet" lang="python">
            from django.http import HttpResponseRedirect

            def some_view(request):
                # logic..
                return HttpResponseRedirect('/new_url/')

            # уязвимость open redirect
            def dangerous_view(request):
                url = request.GET.get('continue')
                return HttpResponseRedirect(url)
        </script>
    </div></section>

    <section class="slide shout"><div>
        <h2>Django forms</h2>
    </div></section>

    <section class="slide"><div>
        <h2>Описание форм</h2>
        <script type="snippet" lang="python">
            class ContactForm(forms.Form):
                email = forms.EmailField(max_length=100)
                message = forms.CharField(widget=forms.Textarea)
                def clean_message(self):
                    message = self.cleaned_data.get('message')
                    if not check_antispam(message):
                        raise form.ValidationError(
                          'Spam detected!')
        </script>
    </div></section>

    <section class="slide"><div>
        <h2>Использование во view</h2>
    </div></section>

    <section class="slide"><div>
        <h2>Использование в шаблонах</h2>
    </div></section>

    <section class="slide"><div>
        <h2>Model forms</h2>
    </div></section>

    <section class="slide shout"><div>
        <h2>Безопасность</h2>
    </div></section>

    <section class="slide"><div>
        <h2>Проверка авторизации</h2>
    </div></section>

    <section class="slide"><div>
        <h2>CSRF</h2>
        TODO: схема
    </div></section>

    <section class="slide"><div>
        <h2>Методы борьбы</h2>
        <ul>
            Капча
            Пароль
            Honey-well
            Динамические имена
        </ul>
    </div></section>

    <div class="progress"><div></div></div>
    <script src="../js/highlight.pack.js"></script>
    <script src="../node_modules/shower-core/shower.min.js"></script>
    <script src="../js/init.js"></script>

</body>
</html>
